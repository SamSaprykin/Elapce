<% layout('layouts/boilerplate') -%>

<head>
    <link rel='stylesheet' href='/stylesheets/project-index.css' />
    <link rel="stylesheet" href='/stylesheets/circles.css'>
    <link rel="preload" href="fonts/GothamPro-Medium.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="fonts/MuseoSansCyrl-100.woff2" as="font" type="font/woff2" crossorigin>
    <link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v2.3.0/mapbox-gl-geocoder.css' type='text/css' />
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.51.0/mapbox-gl.css' rel='stylesheet' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.51.0/mapbox-gl.js'></script>
    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v2.3.0/mapbox-gl-geocoder.min.js'></script>
</head>




<div class="content-wrapper">
    <% include ../partials/searchFilter %>
    <div class="shape-white-catalog"></div>
    
    <h1 class="main-title">Каталог</h1>
    <div class='wrapper-project-index'>
        
        <div class="shape-white-katalog"></div>
        <% projects.docs.forEach(function(project){ %>
            <div class="project-card">
                
                <a href="/projects/<%= project.id %>"><img class="title-image"
                
                src="<%= image_url(project.images[0].public_id, {width: 485, height: 360,  crop: "fit"}) %>"
                alt="<%= project.title %>"></a>    
                
                <h2 class="project-title-index"><%= project.title %></h2>
               <h5 class="project-short-info">  <%= project.area %> м2 | <%= project.bedrooms %> спальни</h5>
                <a class="project-price-index" href="/projects/<%= project.id %>"><div><%= project.price %> $</div></a>
                
            </div> 
        <% }); %>
    </div>

</div>

<% include ../partials/paginateProjects %>
<div id="map"></div>






<script>
    mapboxgl.accessToken = "<%= mapBoxToken %>";
    var projects = { features: <%- JSON.stringify(projects.docs) %> };
</script>
<script src="/javascripts/allPostsClusterMap.js"></script>
